new-term width=80 height=1
----

# Add two history entries and pending input.
input
hello;<Enter>world;<Enter>blort
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> blort ̲                                                                        │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-p>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> world; ̲                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-p>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> hello; ̲                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

# If we're at the beginning of the history entries, previous-history is a noop.
input
<Control-p>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> hello; ̲                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-n>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> world; ̲                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

# next-history after the last history entry moves to the pending input.
input
<Control-n>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> blort ̲                                                                        │
└────────────────────────────────────────────────────────────────────────────────┘

# If we're at the end of the history entries, next-history is a noop.
input
<Control-n>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> blort ̲                                                                        │
└────────────────────────────────────────────────────────────────────────────────┘

# Editing a history entry.
input
<Control-p><Backspace>!
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> world! ̲                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-p>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> hello; ̲                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

# The edited history entry is still edited.
input
<Control-n>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> world! ̲                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

# Suppress duplicate adjacent history entries.
input
<Control-n><Control-a><Control-k>blort;<Enter>blort;<Enter>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│>  ̲                                                                             │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-p>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> blort; ̲                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-p>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> world! ̲                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘
