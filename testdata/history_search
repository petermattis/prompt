new-term width=80 height=2
----

input
hello;<Enter>world;<Enter>foo foo foo;<Enter>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> foo foo foo;                                                                  │
│>  ̲                                                                             │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-r>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│>  ̲                                                                             │
│bck:`'                                                                          │
└────────────────────────────────────────────────────────────────────────────────┘

input
f
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> foo foo f̲oo;                                                                  │
│bck:`f'                                                                         │
└────────────────────────────────────────────────────────────────────────────────┘

input
oo
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> foo foo f̲oo;                                                                  │
│bck:`foo'                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-r>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> foo f̲oo foo;                                                                  │
│bck:`foo'                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-r>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> f̲oo foo foo;                                                                  │
│bck:`foo'                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

# reverse-history-search fails to find a match displays "bck?".
input
<Control-r>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> f̲oo foo foo;                                                                  │
│bck?`foo'                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

# forward-history-search
input
<Control-s>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> foo f̲oo foo;                                                                  │
│fwd:`foo'                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

# forward-history-search fails to find a match displays "fwd?".
input
<Control-s><Control-s>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> foo foo f̲oo;                                                                  │
│fwd?`foo'                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Backspace><Backspace><Backspace>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> foo foo f̲oo;                                                                  │
│fwd:`'                                                                          │
└────────────────────────────────────────────────────────────────────────────────┘

# reverse-history-search moves to previous entry
input
<Control-r>l
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> worl̲d;                                                                        │
│bck:`l'                                                                         │
└────────────────────────────────────────────────────────────────────────────────┘

# reverse-history-search moves to previous entry
input
<Control-r>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> hell̲o;                                                                        │
│bck:`l'                                                                         │
└────────────────────────────────────────────────────────────────────────────────┘

# reverse-history-search fails to find a match displays "bck?".
input
f
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> hell̲o;                                                                        │
│bck?`lf'                                                                        │
└────────────────────────────────────────────────────────────────────────────────┘

# Abort switches back to previous match
input
<Control-g>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> hell̲o;                                                                        │
│bck:`l'                                                                         │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-s>llllllll
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> worl̲d;                                                                        │
│fwd?`lllllllll'                                                                 │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-g>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> worl̲d;                                                                        │
│fwd:`l'                                                                         │
└────────────────────────────────────────────────────────────────────────────────┘

# Cancel exits history search
input
<Control-c>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> worl̲d;                                                                        │
│                                                                                │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-s>foo
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> f̲oo foo foo;                                                                  │
│fwd:`foo'                                                                       │
└────────────────────────────────────────────────────────────────────────────────┘

# Movement commands exit history search
input
<Right>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> fo̲o foo foo;                                                                  │
│                                                                                │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-n>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│>  ̲                                                                             │
│                                                                                │
└────────────────────────────────────────────────────────────────────────────────┘

input
blort
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> blort ̲                                                                        │
│                                                                                │
└────────────────────────────────────────────────────────────────────────────────┘

# History search matches the pending input
input
<Control-r>lo
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> bl̲ort                                                                         │
│bck:`lo'                                                                        │
└────────────────────────────────────────────────────────────────────────────────┘

input
<Control-a>
----
┌────────────────────────────────────────────────────────────────────────────────┐
│> b̲lort                                                                         │
│                                                                                │
└────────────────────────────────────────────────────────────────────────────────┘
